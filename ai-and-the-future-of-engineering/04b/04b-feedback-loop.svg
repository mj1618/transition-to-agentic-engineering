<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600" width="900" height="600">
  <defs>
    <linearGradient id="aiGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#667eea"/>
      <stop offset="100%" stop-color="#764ba2"/>
    </linearGradient>

    <linearGradient id="termHeaderGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#3a3a4a"/>
      <stop offset="100%" stop-color="#2d2d3d"/>
    </linearGradient>

    <linearGradient id="feedbackGrad" x1="100%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#ef4444"/>
      <stop offset="100%" stop-color="#f97316"/>
    </linearGradient>

    <marker id="arrowBlue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#667eea"/>
    </marker>
    <marker id="arrowFeedback" markerWidth="12" markerHeight="8" refX="11" refY="4" orient="auto">
      <polygon points="0 0, 12 4, 0 8" fill="#f97316"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#22c55e"/>
    </marker>

    <filter id="shadow" x="-10%" y="-10%" width="130%" height="130%">
      <feDropShadow dx="2" dy="2" stdDeviation="4" flood-opacity="0.12"/>
    </filter>
  </defs>

  <style>
    .pulse-arrow {
      animation: dashFlow 1.5s linear infinite;
    }
    @keyframes dashFlow {
      from { stroke-dashoffset: 24; }
      to { stroke-dashoffset: 0; }
    }
  </style>

  <rect width="900" height="600" fill="#f0f4f8"/>

  <text x="450" y="38" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#1e293b">The Self-Correcting Feedback Loop</text>
  <text x="450" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" fill="#64748b">AI agents read errors, fix mistakes, and retry automatically</text>

  <!-- ===== STEP 1: AI RUNS COMMAND ===== -->

  <g transform="translate(30, 78)">
    <rect x="0" y="0" width="24" height="24" rx="12" fill="#667eea"/>
    <text x="12" y="17" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">1</text>
  </g>
  <text x="62" y="96" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#4f46e5">AI runs a command</text>

  <!-- AI Agent icon (Step 1) -->
  <g transform="translate(52, 112)">
    <circle cx="45" cy="42" r="38" fill="url(#aiGrad)" opacity="0.12"/>
    <circle cx="45" cy="42" r="32" fill="url(#aiGrad)"/>
    <rect x="26" y="29" width="38" height="28" rx="5" fill="none" stroke="white" stroke-width="2.5"/>
    <circle cx="37" cy="42" r="4.5" fill="white"/>
    <circle cx="53" cy="42" r="4.5" fill="white"/>
    <rect x="33" y="52" width="24" height="2.5" rx="1.2" fill="white"/>
    <rect x="40" y="18" width="10" height="12" rx="2.5" fill="none" stroke="white" stroke-width="2"/>
    <text x="45" y="92" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#5b21b6" font-weight="bold">AI Agent</text>
  </g>

  <!-- Arrow: AI to Terminal 1 -->
  <line x1="145" y1="154" x2="295" y2="154" stroke="#667eea" stroke-width="2.5" marker-end="url(#arrowBlue)"/>
  <text x="220" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#667eea" font-weight="bold">executes</text>

  <!-- Terminal 1 (Error) -->
  <g transform="translate(308, 102)">
    <rect x="0" y="0" width="560" height="118" rx="8" fill="#1e1e2e" filter="url(#shadow)"/>
    <rect x="0" y="0" width="560" height="26" rx="8" fill="url(#termHeaderGrad)"/>
    <rect x="0" y="14" width="560" height="12" fill="url(#termHeaderGrad)"/>
    <circle cx="16" cy="13" r="4.5" fill="#ff5f57"/>
    <circle cx="32" cy="13" r="4.5" fill="#febc2e"/>
    <circle cx="48" cy="13" r="4.5" fill="#28c840"/>
    <text x="280" y="17" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Terminal</text>

    <text x="14" y="48" font-family="monospace, Courier" font-size="13" fill="#6e6e82">$</text>
    <text x="28" y="48" font-family="monospace, Courier" font-size="13" fill="#e8e8f0">python3 app.py</text>

    <text x="14" y="68" font-family="monospace, Courier" font-size="11" fill="#6e6e82">Traceback (most recent call last):</text>
    <text x="14" y="84" font-family="monospace, Courier" font-size="11" fill="#6e6e82">  File "app.py", line 1, in &lt;module&gt;</text>
    <text x="14" y="102" font-family="monospace, Courier" font-size="12" fill="#ef4444" font-weight="bold">ImportError: No module named 'flask'</text>

    <rect x="468" y="84" width="76" height="24" rx="5" fill="#ef4444" opacity="0.15"/>
    <rect x="468" y="84" width="76" height="24" rx="5" fill="none" stroke="#ef4444" stroke-width="1.5"/>
    <text x="484" y="101" font-family="Arial, sans-serif" font-size="14" fill="#ef4444">&#10008;</text>
    <text x="498" y="100" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#ef4444">FAIL</text>
  </g>

  <!-- ===== STEP 2: ERROR FEEDS BACK ===== -->

  <g transform="translate(30, 238)">
    <rect x="0" y="0" width="24" height="24" rx="12" fill="#f97316"/>
    <text x="12" y="17" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">2</text>
  </g>
  <text x="62" y="256" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#ea580c">Error feeds back to AI</text>

  <!-- Feedback arrow: curves from terminal error back to AI -->
  <path d="M 588 224 C 588 280, 300 290, 97 295"
        stroke="url(#feedbackGrad)" stroke-width="4" fill="none"
        stroke-dasharray="12,12" class="pulse-arrow"
        marker-end="url(#arrowFeedback)"/>

  <!-- Error message label on the feedback arrow -->
  <g transform="translate(240, 268)">
    <rect x="0" y="0" width="260" height="22" rx="4" fill="#fef2f2" stroke="#fca5a5" stroke-width="1"/>
    <text x="130" y="15" text-anchor="middle" font-family="monospace, Courier" font-size="10" fill="#dc2626">"No module named 'flask'"</text>
  </g>

  <!-- AI thinking bubble -->
  <g transform="translate(35, 310)">
    <rect x="0" y="0" width="155" height="50" rx="8" fill="white" stroke="#c4b5fd" stroke-width="1.5" filter="url(#shadow)"/>
    <polygon points="50,-8 60,0 70,-8" fill="white" stroke="#c4b5fd" stroke-width="1.5"/>
    <line x1="51" y1="0" x2="69" y2="0" stroke="white" stroke-width="2.5"/>
    <text x="78" y="18" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#5b21b6" font-style="italic">"Flask is missing.</text>
    <text x="78" y="32" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#5b21b6" font-style="italic">I'll install it first,</text>
    <text x="78" y="44" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#5b21b6" font-style="italic">then run again."</text>
  </g>

  <!-- ===== STEP 3: AI FIXES AND RETRIES ===== -->

  <g transform="translate(30, 380)">
    <rect x="0" y="0" width="24" height="24" rx="12" fill="#22c55e"/>
    <text x="12" y="17" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">3</text>
  </g>
  <text x="62" y="398" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#16a34a">AI fixes and retries</text>

  <!-- AI Agent icon (Step 3) -->
  <g transform="translate(52, 412)">
    <circle cx="45" cy="42" r="38" fill="#22c55e" opacity="0.1"/>
    <circle cx="45" cy="42" r="32" fill="url(#aiGrad)"/>
    <rect x="26" y="29" width="38" height="28" rx="5" fill="none" stroke="white" stroke-width="2.5"/>
    <circle cx="37" cy="42" r="4.5" fill="white"/>
    <circle cx="53" cy="42" r="4.5" fill="white"/>
    <path d="M 34 52 Q 45 59 56 52" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
    <circle cx="45" cy="12" r="8" fill="#22c55e"/>
    <path d="M 41 12 L 44 15 L 50 9" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <text x="45" y="92" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#5b21b6" font-weight="bold">AI Agent</text>
  </g>

  <!-- Arrow: AI to Terminal 2 -->
  <line x1="145" y1="454" x2="295" y2="454" stroke="#22c55e" stroke-width="2.5" marker-end="url(#arrowGreen)"/>
  <text x="220" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#22c55e" font-weight="bold">retries</text>

  <!-- Terminal 2 (Success) -->
  <g transform="translate(308, 402)">
    <rect x="0" y="0" width="560" height="118" rx="8" fill="#1e1e2e" filter="url(#shadow)"/>
    <rect x="0" y="0" width="560" height="26" rx="8" fill="url(#termHeaderGrad)"/>
    <rect x="0" y="14" width="560" height="12" fill="url(#termHeaderGrad)"/>
    <circle cx="16" cy="13" r="4.5" fill="#ff5f57"/>
    <circle cx="32" cy="13" r="4.5" fill="#febc2e"/>
    <circle cx="48" cy="13" r="4.5" fill="#28c840"/>
    <text x="280" y="17" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Terminal</text>

    <text x="14" y="48" font-family="monospace, Courier" font-size="13" fill="#6e6e82">$</text>
    <text x="28" y="48" font-family="monospace, Courier" font-size="13" fill="#e8e8f0">pip install flask &amp;&amp; python3 app.py</text>

    <text x="14" y="68" font-family="monospace, Courier" font-size="11" fill="#6e6e82">Successfully installed flask-3.1.0</text>
    <text x="14" y="86" font-family="monospace, Courier" font-size="12" fill="#22c55e" font-weight="bold"> * Running on http://localhost:5000</text>
    <text x="14" y="104" font-family="monospace, Courier" font-size="11" fill="#22c55e">Press CTRL+C to quit</text>

    <rect x="462" y="84" width="82" height="24" rx="5" fill="#22c55e" opacity="0.15"/>
    <rect x="462" y="84" width="82" height="24" rx="5" fill="none" stroke="#22c55e" stroke-width="1.5"/>
    <text x="478" y="101" font-family="Arial, sans-serif" font-size="14" fill="#22c55e">&#10004;</text>
    <text x="494" y="100" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#22c55e">PASS</text>
  </g>

  <!-- ===== KEY INSIGHT ===== -->
  <g transform="translate(100, 540)">
    <rect x="0" y="0" width="700" height="46" rx="10" fill="#eef2ff" stroke="#818cf8" stroke-width="2"/>
    <text x="350" y="18" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#4338ca">Key Insight</text>
    <text x="350" y="36" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#6366f1">The error &#8594; understand &#8594; fix &#8594; retry loop runs automatically. No human needed.</text>
  </g>
</svg>
