<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Transition to Agentic Engineering</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Outfit:wght@300;400;700;800;900&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    html, body {
      width: 100%; height: 100%;
      overflow: hidden;
      font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #0c0c18;
      color: #e8e8f0;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse at 50% 30%, rgba(99,102,241,0.12) 0%, transparent 60%),
        radial-gradient(ellipse at 80% 80%, rgba(139,92,246,0.06) 0%, transparent 50%);
      pointer-events: none;
    }

    #app {
      width: 100vw; height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      z-index: 1;
    }

    .slide {
      width: 100%; height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding: 50px 40px 80px;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: scale(0.97); }
      to   { opacity: 1; transform: scale(1); }
    }

    @keyframes gradientShift {
      0%   { background-position: 0% 50%; }
      50%  { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* ---- Title ---- */
    .slide-title h1 {
      font-family: 'Outfit', sans-serif;
      font-size: clamp(2.8rem, 5.5vw, 5.5rem);
      font-weight: 900;
      text-align: center;
      letter-spacing: -0.03em;
      line-height: 1.1;
      background: linear-gradient(135deg, #a78bfa, #818cf8, #60a5fa, #c084fc, #f472b6, #a78bfa);
      background-size: 300% 300%;
      animation: gradientShift 8s ease infinite;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 0 40px rgba(129,140,248,0.35));
    }

    /* ---- References ---- */
    .slide-references h2 {
      font-family: 'Outfit', sans-serif;
      font-size: clamp(2rem, 4vw, 3rem);
      font-weight: 800;
      margin-bottom: 40px;
      background: linear-gradient(135deg, #c4b5fd, #93c5fd);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 0 30px rgba(139,92,246,0.3));
    }

    .ref-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 20px;
      max-width: 600px;
      width: 100%;
    }

    .ref-list li {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .ref-list .ref-name {
      font-family: 'Outfit', sans-serif;
      font-size: 1.25rem;
      font-weight: 600;
      color: #e8e8f0;
    }

    .ref-list a {
      font-size: 0.95rem;
      color: #818cf8;
      text-decoration: none;
      transition: color 0.15s;
      word-break: break-all;
    }

    .ref-list a:hover {
      color: #a78bfa;
      text-decoration: underline;
    }

    .ref-divider {
      width: 100%;
      max-width: 600px;
      border: none;
      border-top: 1px solid rgba(255,255,255,0.08);
      margin: 8px 0;
    }

    /* ---- Thank You ---- */
    .slide-thankyou h1 {
      font-family: 'Outfit', sans-serif;
      font-size: clamp(3.5rem, 8vw, 7rem);
      font-weight: 900;
      letter-spacing: -0.03em;
      background: linear-gradient(135deg, #f472b6, #fb923c, #fbbf24, #a78bfa, #f472b6);
      background-size: 300% 300%;
      animation: gradientShift 6s ease infinite;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 0 40px rgba(244,114,182,0.3));
    }

    /* ---- Single image ---- */
    .slide-single { padding: 20px 20px 70px; }
    .slide-single img {
      max-width: 95%;
      max-height: 88vh;
      object-fit: contain;
      border-radius: 6px;
    }

    /* ---- Photo with caption ---- */
    .slide-photo { padding: 0; position: relative; }
    .slide-photo img {
      width: 100%; height: 100%;
      object-fit: cover;
    }
    .slide-photo .photo-caption {
      position: absolute;
      bottom: 0; left: 0; right: 0;
      padding: 60px 50px 90px;
      background: linear-gradient(transparent, rgba(0,0,0,0.88));
    }
    .slide-photo .photo-caption h2 {
      font-family: 'Outfit', sans-serif;
      font-size: clamp(2rem, 4vw, 3.2rem);
      font-weight: 800;
      color: #fff;
      margin-bottom: 8px;
      letter-spacing: -0.02em;
    }
    .slide-photo .photo-caption p {
      font-size: 1.15rem;
      color: rgba(255,255,255,0.75);
      line-height: 1.5;
    }

    /* ---- Statement ---- */
    .slide-statement h1 {
      font-family: 'Outfit', sans-serif;
      font-size: clamp(2rem, 3.8vw, 3.6rem);
      font-weight: 400;
      text-align: center;
      line-height: 1.35;
      color: #9898b0;
      max-width: 900px;
      letter-spacing: -0.01em;
    }

    .slide-statement h1 strong {
      font-weight: 800;
      background: linear-gradient(135deg, #c4b5fd, #93c5fd);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* ---- Embed ---- */
    .slide-embed .embed-container {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      max-width: 620px;
    }

    /* ---- Intro ---- */
    .slide-intro .bio {
      text-align: center;
      margin-bottom: 28px;
    }

    .slide-intro .bio h2 {
      font-family: 'Outfit', sans-serif;
      font-size: clamp(2.2rem, 4.5vw, 3.5rem);
      font-weight: 800;
      margin-bottom: 16px;
      background: linear-gradient(135deg, #c4b5fd, #93c5fd);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 0 30px rgba(139,92,246,0.3));
    }

    .slide-intro .bio p {
      font-size: 1.1rem;
      line-height: 2;
      color: #b0b0c8;
      letter-spacing: 0.01em;
    }

    .intro-photos {
      display: flex;
      gap: 14px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .intro-photos img {
      width: 140px; height: 140px;
      object-fit: cover;
      border-radius: 14px;
      border: 2px solid rgba(129,140,248,0.2);
      cursor: pointer;
      transition: transform 0.2s, border-color 0.2s, box-shadow 0.2s;
    }

    .intro-photos img:hover {
      transform: scale(1.06);
      border-color: rgba(129,140,248,0.5);
      box-shadow: 0 4px 20px rgba(129,140,248,0.15);
    }

    /* ---- Gallery ---- */
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
      gap: 14px;
      max-width: 950px;
      width: 100%;
      padding: 10px;
    }

    .gallery-item {
      aspect-ratio: 4/3;
      border-radius: 10px;
      overflow: hidden;
      cursor: pointer;
      border: 2px solid rgba(255,255,255,0.06);
      transition: transform 0.2s, border-color 0.2s, box-shadow 0.2s;
      background: #12121e;
    }

    .gallery-item:hover {
      transform: scale(1.04);
      border-color: rgba(129,140,248,0.4);
      box-shadow: 0 4px 20px rgba(0,0,0,0.4);
    }

    .gallery-item img {
      width: 100%; height: 100%;
      object-fit: cover;
      display: block;
    }

    .gallery-item.embed-thumb {
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #161628, #1e1e38);
      flex-direction: column;
    }

    .embed-icon {
      width: 36px; height: 36px;
      border: 2px solid #818cf8;
      border-radius: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #818cf8;
      font-size: 1.1rem;
      font-weight: 700;
    }

    .embed-label {
      font-size: 0.85rem;
      color: #888;
    }

    /* ---- Lightbox ---- */
    #lightbox {
      position: fixed;
      inset: 0;
      background: rgba(4,4,10,0.94);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      cursor: pointer;
      animation: lbIn 0.2s ease;
    }

    @keyframes lbIn {
      from { opacity: 0; }
      to   { opacity: 1; }
    }

    #lightbox.hidden { display: none; }

    #lightbox-content {
      max-width: 92vw;
      max-height: 92vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #lightbox-content img {
      max-width: 92vw;
      max-height: 92vh;
      object-fit: contain;
      border-radius: 6px;
    }

    #lightbox-content iframe {
      border-radius: 8px;
    }

    /* ---- Nav controls ---- */
    /* ---- Slide Panel ---- */
    #slide-panel {
      position: fixed;
      top: 0; left: 0; bottom: 0;
      width: 200px;
      background: rgba(12,12,24,0.96);
      border-right: 1px solid rgba(255,255,255,0.08);
      z-index: 200;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 10px 8px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      scrollbar-width: thin;
      scrollbar-color: rgba(255,255,255,0.12) transparent;
      transition: transform 0.25s ease;
    }

    #slide-panel::-webkit-scrollbar { width: 5px; }
    #slide-panel::-webkit-scrollbar-track { background: transparent; }
    #slide-panel::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,0.12);
      border-radius: 3px;
    }

    #slide-panel.collapsed { transform: translateX(-200px); }

    #panel-toggle {
      position: fixed;
      top: 12px; left: 12px;
      z-index: 201;
      width: 32px; height: 32px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 6px;
      color: #888;
      cursor: pointer;
      font-size: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    #panel-toggle:hover {
      background: rgba(255,255,255,0.12);
      color: #ccc;
    }

    #panel-toggle.shifted { left: 212px; }

    .panel-thumb {
      position: relative;
      width: 100%;
      aspect-ratio: 16/10;
      border-radius: 6px;
      overflow: hidden;
      cursor: grab;
      border: 2px solid transparent;
      background: #0c0c18;
      flex-shrink: 0;
      transition: border-color 0.15s, box-shadow 0.15s;
    }

    .panel-thumb:hover { border-color: rgba(129,140,248,0.3); }

    .panel-thumb.active {
      border-color: #818cf8;
      box-shadow: 0 0 12px rgba(129,140,248,0.25);
    }

    .panel-thumb.drag-over {
      border-color: #f472b6;
      box-shadow: 0 0 12px rgba(244,114,182,0.3);
    }

    .panel-thumb.dragging { opacity: 0.3; }

    .thumb-viewport {
      width: 1920px;
      height: 1200px;
      transform-origin: top left;
      transform: scale(calc(184 / 1920));
      pointer-events: none;
      position: absolute;
      top: 0; left: 0;
    }

    .thumb-viewport .slide {
      width: 1920px;
      height: 1200px;
      padding: 50px 40px 80px;
      animation: none;
    }

    .thumb-viewport .slide-photo img {
      width: 1920px; height: 1200px;
    }

    .panel-num {
      position: absolute;
      bottom: 2px; right: 4px;
      font-size: 10px;
      color: rgba(255,255,255,0.4);
      font-family: 'Space Grotesk', monospace;
      pointer-events: none;
    }

    body.panel-open #app { margin-left: 200px; width: calc(100vw - 200px); }
    body.panel-open #controls { margin-left: 100px; }

    #controls {
      position: fixed;
      bottom: 22px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      align-items: center;
      gap: 18px;
      z-index: 100;
    }

    #controls button {
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.1);
      color: #999;
      width: 40px; height: 40px;
      border-radius: 50%;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.15s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #controls button:hover:not(:disabled) {
      background: rgba(255,255,255,0.12);
      color: #ddd;
      border-color: rgba(255,255,255,0.2);
    }

    #controls button:disabled { opacity: 0.25; cursor: default; }

    #slide-counter {
      font-family: 'Space Grotesk', monospace;
      font-size: 0.8rem;
      color: #555;
      min-width: 55px;
      text-align: center;
      font-variant-numeric: tabular-nums;
      letter-spacing: 0.05em;
    }
  </style>
</head>
<body>
  <div id="slide-panel"></div>
  <button id="panel-toggle" class="shifted">&#9776;</button>
  <div id="app"></div>
  <div id="lightbox" class="hidden">
    <div id="lightbox-content"></div>
  </div>
  <nav id="controls">
    <button id="prev">&#8592;</button>
    <span id="slide-counter"></span>
    <button id="next">&#8594;</button>
  </nav>

  <script>
    var BASE = 'ai-and-the-future-of-engineering';

    var slides = [
      { type: 'title' },

      {
        type: 'intro',
        name: "I'm Matt!",
        lines: [
          'Ex-CTO @ VGW',
          'Co-Founder @ SupplyWise',
          '',
          'Functional programmer (10+ ICFP Contest participant)',
          'Builder of development tools (swarm-cli, playwright-electron-cli)',
          'Lover of dogs',
          'Tennis enthusiast'
        ],
        images: []
      },

      { type: 'single', src: BASE + '/01/01-autonomy-threshold.svg' },

      {
        type: 'embed',
        embedHtml: '<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">this is what AUTOMATED UI testing looks like<br><br>testing <a href="https://twitter.com/Twitch?ref_src=twsrc%5Etfw">@Twitch</a>&#39;s with Maestro <a href="https://t.co/orXqgVoem8">pic.twitter.com/orXqgVoem8</a></p>&mdash; Maestro (@maestro__dev) <a href="https://twitter.com/maestro__dev/status/2017975473641308352?ref_src=twsrc%5Etfw">February 1, 2026</a></blockquote>'
      },

      {
        type: 'embed',
        embedHtml: '<iframe width="560" height="315" src="https://www.youtube.com/embed/0YhJxJZOWBw?si=4emOjzCN2BmpUaqh&amp;clip=UgkxHO6Jj3K-topkSKV6bbIpaGRmTi10RFMa&amp;clipt=ENoyGJLcAw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>'
      },

      {
        type: 'statement',
        html: 'The lack of hands-on human coding <strong>introduced a different kind of engineering work, focused on systems, scaffolding, and leverage</strong>.'
      },

      { type: 'single', src: BASE + '/03a/03a-context-matters.svg' },
      { type: 'single', src: BASE + '/03b/03b-context-crafting.svg' },
      { type: 'single', src: BASE + '/03c/03c-context-degradation.svg' },
      { type: 'single', src: BASE + '/04a/04-ralph.svg' },
      { type: 'single', src: BASE + '/04c/04c-feedback-loop.svg' },
      { type: 'single', src: BASE + '/04c/04c-compiler-gradient-descent.svg' },
      { type: 'single', src: BASE + '/04b/04b-simplest-agent-loop.svg' },
      { type: 'single', src: BASE + '/04b/04b-swarm.gif' },

      {
        type: 'photo',
        src: BASE + '/Desire_path_-_52849400711.jpg',
        title: 'The Desire Path',
        subtitle: 'Engineers will find their own way to use AI \u2014 your job is to pave the path'
      },

      { type: 'single', src: BASE + '/04d-mcp-to-cli/04d-mcp-to-cli.svg' },

      { type: 'single', src: BASE + '/04d/04d-what-matters.svg' },
      { type: 'single', src: BASE + '/04d-plan-and-execute/04d-plan-and-execute.svg' },
      { type: 'single', src: BASE + '/04d1/04d1-not-easy.svg' },
      { type: 'single', src: BASE + '/04d2/04d2-stop-reading-code.svg' },
      { type: 'single', src: BASE + '/04e/04e-where-to-start.svg' },

      { type: 'single', src: BASE + '/05/05-models-pricing.png' },
      { type: 'single', src: BASE + '/08/08-engineering-enablement.svg' },

      {
        type: 'gallery',
        items: [
          { kind: 'image', src: BASE + '/09/09a-moltbook.png' },
          { kind: 'image', src: BASE + '/09/09b-moltbook.webp' },
          { kind: 'image', src: BASE + '/09/09c-moltbook.png' },
          { kind: 'image', src: BASE + '/09/09d-moltbook.png' },
          { kind: 'image', src: BASE + '/09/09e-moltbook.jpeg' }
        ]
      },

      {
        type: 'gallery',
        items: [
          { kind: 'image', src: BASE + '/10/10a-church-of-molt.png' },
          { kind: 'image', src: BASE + '/10/10b-moltcity.png' },
          { kind: 'image', src: BASE + '/10/10c-moltmatch.png' },
          { kind: 'image', src: BASE + '/10/10d-molthub.png' },
          { kind: 'image', src: BASE + '/10/10e-molthub.png' },
          { kind: 'image', src: BASE + '/10/10f-rentahuman.png' },
          { kind: 'image', src: BASE + '/10/10g-rentahuman.png' },
          {
            kind: 'embed',
            label: 'LinkedIn Post',
            embedHtml: '<iframe src="https://www.linkedin.com/embed/feed/update/urn:li:ugcPost:7423758592371101696?compact=1" height="500" width="504" frameborder="0" allowfullscreen="" title="Embedded post" style="background:#fff;border-radius:8px;"></iframe>'
          }
        ]
      },


      { type: 'single', src: BASE + '/12/12-engineer-value.svg' },

      {
        type: 'references',
        sections: [
          { heading: 'Inspiration', refs: [
            { name: 'Steve Yegge', url: 'https://steve-yegge.medium.com/' },
            { name: 'Geoff Huntley', url: 'https://ghuntley.com' }
          ]},
          { heading: 'Find Me', refs: [
            { name: 'GitHub', url: 'https://github.com/mj1618/' },
            { name: 'LinkedIn', url: 'https://www.linkedin.com/in/matthewstephenjames/' }
          ]}
        ]
      },

      { type: 'thankyou' }
    ];

    var currentSlide = 0;
    var app = document.getElementById('app');
    var lightbox = document.getElementById('lightbox');
    var lightboxContent = document.getElementById('lightbox-content');
    var counter = document.getElementById('slide-counter');
    var prevBtn = document.getElementById('prev');
    var nextBtn = document.getElementById('next');
    var panel = document.getElementById('slide-panel');
    var panelToggle = document.getElementById('panel-toggle');
    var twitterLoaded = false;
    var panelOpen = true;
    var dragSrcIdx = null;

    document.body.classList.add('panel-open');

    function loadTwitter() {
      if (twitterLoaded) return;
      twitterLoaded = true;
      var s = document.createElement('script');
      s.src = 'https://platform.twitter.com/widgets.js';
      s.async = true;
      document.head.appendChild(s);
    }

    function esc(str) {
      var d = document.createElement('div');
      d.appendChild(document.createTextNode(str));
      return d.innerHTML;
    }

    function renderSlide() {
      var slide = slides[currentSlide];
      var html = '';

      switch (slide.type) {
        case 'title':
          html = '<div class="slide slide-title"><h1>The Transition<br>to Agentic Engineering</h1></div>';
          break;

        case 'thankyou':
          html = '<div class="slide slide-thankyou"><h1>Thank You</h1></div>';
          break;

        case 'intro':
          var bio = slide.lines.map(function(l) {
            return l === '' ? '<br>' : esc(l);
          }).join('<br>');
          var photos = slide.images.map(function(src, i) {
            return '<img src="' + esc(src) + '" data-lb-src="' + esc(src) + '" />';
          }).join('');
          html = '<div class="slide slide-intro">' +
            '<div class="bio"><h2>' + esc(slide.name) + '</h2><p>' + bio + '</p></div>' +
            '<div class="intro-photos">' + photos + '</div></div>';
          break;

        case 'single':
          html = '<div class="slide slide-single"><img src="' + esc(slide.src) + '" /></div>';
          break;

        case 'photo':
          html = '<div class="slide slide-photo">' +
            '<img src="' + esc(slide.src) + '" />' +
            '<div class="photo-caption"><h2>' + esc(slide.title) + '</h2>' +
            (slide.subtitle ? '<p>' + esc(slide.subtitle) + '</p>' : '') +
            '</div></div>';
          break;

        case 'statement':
          html = '<div class="slide slide-statement"><h1>' + slide.html + '</h1></div>';
          break;

        case 'embed':
          html = '<div class="slide slide-embed"><div class="embed-container">' +
            slide.embedHtml + '</div></div>';
          break;

        case 'references':
          var refSections = slide.sections.map(function(section) {
            var refItems = section.refs.map(function(ref) {
              return '<li><span class="ref-name">' + esc(ref.name) + '</span>' +
                '<a href="' + esc(ref.url) + '" target="_blank" rel="noopener">' + esc(ref.url) + '</a></li>';
            }).join('');
            return '<h3 style="font-family:Outfit,sans-serif;font-size:1rem;font-weight:600;color:#666;text-transform:uppercase;letter-spacing:0.1em;margin-bottom:-8px;">' +
              esc(section.heading) + '</h3><ul class="ref-list">' + refItems + '</ul>';
          }).join('<hr class="ref-divider">');
          html = '<div class="slide slide-references"><h2>References</h2>' + refSections + '</div>';
          break;

        case 'gallery':
          var items = slide.items.map(function(item, i) {
            if (item.kind === 'image') {
              return '<div class="gallery-item" data-lb-src="' + esc(item.src) + '">' +
                '<img src="' + esc(item.src) + '" loading="lazy" /></div>';
            } else if (item.kind === 'embed') {
              return '<div class="gallery-item embed-thumb" data-embed-idx="' + i + '">' +
                '<div><div class="embed-icon">in</div>' +
                '<div class="embed-label">' + esc(item.label) + '</div></div></div>';
            }
            return '';
          }).join('');
          html = '<div class="slide slide-gallery">' +
            '<div class="gallery-grid">' + items + '</div></div>';
          break;
      }

      app.innerHTML = html;
      counter.textContent = (currentSlide + 1) + ' / ' + slides.length;
      prevBtn.disabled = currentSlide === 0;
      nextBtn.disabled = currentSlide === slides.length - 1;

      app.querySelectorAll('[data-lb-src]').forEach(function(el) {
        el.addEventListener('click', function() {
          var src = el.getAttribute('data-lb-src');
          lightboxContent.innerHTML = '<img src="' + esc(src) + '" />';
          lightbox.classList.remove('hidden');
        });
      });

      app.querySelectorAll('[data-embed-idx]').forEach(function(el) {
        el.addEventListener('click', function() {
          var idx = parseInt(el.getAttribute('data-embed-idx'));
          var item = slide.items[idx];
          if (item && item.embedHtml) {
            lightboxContent.innerHTML = item.embedHtml;
            lightbox.classList.remove('hidden');
          }
        });
      });

      if (slide.type === 'embed') {
        loadTwitter();
        var poll = setInterval(function() {
          if (window.twttr && window.twttr.widgets) {
            clearInterval(poll);
            window.twttr.widgets.load(app);
          }
        }, 150);
      }

      updatePanelActive();
      scrollThumbIntoView();
    }

    function navigate(dir) {
      var n = currentSlide + dir;
      if (n >= 0 && n < slides.length) {
        currentSlide = n;
        renderSlide();
      }
    }

    function closeLightbox() {
      lightbox.classList.add('hidden');
      lightboxContent.innerHTML = '';
    }

    lightbox.addEventListener('click', closeLightbox);

    prevBtn.addEventListener('click', function() { navigate(-1); });
    nextBtn.addEventListener('click', function() { navigate(1); });

    document.addEventListener('keydown', function(e) {
      if (!lightbox.classList.contains('hidden')) {
        if (e.key === 'Escape') { closeLightbox(); e.preventDefault(); }
        return;
      }
      if (e.key === 'ArrowRight' || e.key === ' ') { navigate(1); e.preventDefault(); }
      else if (e.key === 'ArrowLeft') { navigate(-1); e.preventDefault(); }
    });

    /* ---- Panel toggle ---- */
    panelToggle.addEventListener('click', function() {
      panelOpen = !panelOpen;
      panel.classList.toggle('collapsed', !panelOpen);
      panelToggle.classList.toggle('shifted', panelOpen);
      document.body.classList.toggle('panel-open', panelOpen);
    });

    /* ---- Render a slide's HTML for thumbnails (simplified) ---- */
    function renderSlideHtml(slide) {
      switch (slide.type) {
        case 'title':
          return '<div class="slide slide-title"><h1>The Transition<br>to Agentic Engineering</h1></div>';
        case 'thankyou':
          return '<div class="slide slide-thankyou"><h1>Thank You</h1></div>';
        case 'intro':
          var bio = slide.lines.map(function(l) { return l === '' ? '<br>' : esc(l); }).join('<br>');
          var photos = slide.images.map(function(src) {
            return '<img src="' + esc(src) + '" />';
          }).join('');
          return '<div class="slide slide-intro"><div class="bio"><h2>' + esc(slide.name) + '</h2><p>' + bio + '</p></div><div class="intro-photos">' + photos + '</div></div>';
        case 'single':
          return '<div class="slide slide-single"><img src="' + esc(slide.src) + '" /></div>';
        case 'photo':
          return '<div class="slide slide-photo"><img src="' + esc(slide.src) + '" /><div class="photo-caption"><h2>' + esc(slide.title) + '</h2>' + (slide.subtitle ? '<p>' + esc(slide.subtitle) + '</p>' : '') + '</div></div>';
        case 'statement':
          return '<div class="slide slide-statement"><h1>' + slide.html + '</h1></div>';
        case 'embed':
          return '<div class="slide slide-embed" style="background:#161628;"><div style="display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:#818cf8;font-size:120px;font-family:Outfit,sans-serif;">&#x1F426;</div></div>';
        case 'references':
          var refSections = slide.sections.map(function(section) {
            var refItems = section.refs.map(function(ref) {
              return '<li><span class="ref-name">' + esc(ref.name) + '</span></li>';
            }).join('');
            return '<h3 style="font-family:Outfit,sans-serif;font-size:1rem;font-weight:600;color:#666;text-transform:uppercase;letter-spacing:0.1em;margin-bottom:-8px;">' + esc(section.heading) + '</h3><ul class="ref-list">' + refItems + '</ul>';
          }).join('<hr class="ref-divider">');
          return '<div class="slide slide-references"><h2>References</h2>' + refSections + '</div>';
        case 'gallery':
          var items = slide.items.slice(0, 6).map(function(item) {
            if (item.kind === 'image') {
              return '<div class="gallery-item"><img src="' + esc(item.src) + '" loading="lazy" /></div>';
            }
            return '<div class="gallery-item embed-thumb"><div><div class="embed-icon">in</div><div class="embed-label">' + esc(item.label) + '</div></div></div>';
          }).join('');
          return '<div class="slide slide-gallery"><div class="gallery-grid">' + items + '</div></div>';
        default:
          return '<div class="slide"></div>';
      }
    }

    /* ---- Build / rebuild the panel ---- */
    function renderPanel() {
      panel.innerHTML = '';
      slides.forEach(function(slide, i) {
        var thumb = document.createElement('div');
        thumb.className = 'panel-thumb' + (i === currentSlide ? ' active' : '');
        thumb.draggable = true;
        thumb.setAttribute('data-idx', i);

        var viewport = document.createElement('div');
        viewport.className = 'thumb-viewport';
        viewport.innerHTML = renderSlideHtml(slide);
        thumb.appendChild(viewport);

        var num = document.createElement('span');
        num.className = 'panel-num';
        num.textContent = i + 1;
        thumb.appendChild(num);

        /* Click to navigate */
        thumb.addEventListener('click', function(e) {
          if (thumb.classList.contains('dragging')) return;
          currentSlide = i;
          renderSlide();
          updatePanelActive();
          scrollThumbIntoView();
        });

        /* Drag start */
        thumb.addEventListener('dragstart', function(e) {
          dragSrcIdx = i;
          thumb.classList.add('dragging');
          e.dataTransfer.effectAllowed = 'move';
          e.dataTransfer.setData('text/plain', String(i));
        });

        thumb.addEventListener('dragend', function() {
          thumb.classList.remove('dragging');
          panel.querySelectorAll('.panel-thumb').forEach(function(t) {
            t.classList.remove('drag-over');
          });
          dragSrcIdx = null;
        });

        thumb.addEventListener('dragover', function(e) {
          e.preventDefault();
          e.dataTransfer.dropEffect = 'move';
          var target = closestThumb(e.target);
          if (target && parseInt(target.getAttribute('data-idx')) !== dragSrcIdx) {
            target.classList.add('drag-over');
          }
        });

        thumb.addEventListener('dragleave', function(e) {
          var target = closestThumb(e.target);
          if (target) target.classList.remove('drag-over');
        });

        thumb.addEventListener('drop', function(e) {
          e.preventDefault();
          var fromIdx = parseInt(e.dataTransfer.getData('text/plain'));
          var toIdx = parseInt(thumb.getAttribute('data-idx'));
          if (fromIdx === toIdx) return;

          var moved = slides.splice(fromIdx, 1)[0];
          slides.splice(toIdx, 0, moved);

          if (currentSlide === fromIdx) {
            currentSlide = toIdx;
          } else if (fromIdx < currentSlide && toIdx >= currentSlide) {
            currentSlide--;
          } else if (fromIdx > currentSlide && toIdx <= currentSlide) {
            currentSlide++;
          }

          renderPanel();
          renderSlide();
          scrollThumbIntoView();
        });

        panel.appendChild(thumb);
      });
    }

    function closestThumb(el) {
      while (el && !el.classList.contains('panel-thumb')) el = el.parentElement;
      return el;
    }

    function updatePanelActive() {
      panel.querySelectorAll('.panel-thumb').forEach(function(t, i) {
        t.classList.toggle('active', i === currentSlide);
      });
    }

    function scrollThumbIntoView() {
      var active = panel.querySelector('.panel-thumb.active');
      if (active) active.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
    }

    renderPanel();
    renderSlide();
  </script>
</body>
</html>
